{% extends "base.html" %}
{% block title %}Home - TypedLines{% endblock %}

{% block content %}
<div class="container mt-4">

    <!-- Featured Blog Carousel -->
    {% if featured_blogs %}
    <div id="featuredCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-inner rounded shadow-sm">
            {% for blog in featured_blogs %}
            <div class="carousel-item {% if loop.first %}active{% endif %}">
                <a href="{{ url_for('view_blog', id=blog.id) }}" class="position-relative d-block">
                    <img src="{{ url_for('static', filename='uploads/covers/' ~ blog.cover_image) }}"
                        class="d-block w-100 img-fluid" alt="Featured Cover"
                        style="max-height: 400px; object-fit: cover;">

                    <!-- Overlay with gradient -->
                    <div class="carousel-caption d-none d-md-block p-4 rounded" style="background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.8) 100%);
                            bottom: 0; left: 0; right: 0; position: absolute; text-align: left;">
                        <h3 class="text-white fw-bold">{{ blog.title }}</h3>
                        <p class="text-light fs-5">{{ blog.subtitle }}</p>
                        <small class="text-light fst-italic">Published on {{ blog.date_created|datetime }}</small>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>

        <!-- Carousel controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#featuredCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#featuredCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>

        <!-- Optional indicators -->
        <div class="carousel-indicators mt-3">
            {% for blog in featured_blogs %}
            <button type="button" data-bs-target="#featuredCarousel" data-bs-slide-to="{{ loop.index0 }}"
                class="{% if loop.first %}active{% endif %}" aria-current="{{ 'true' if loop.first else 'false' }}"
                aria-label="Slide {{ loop.index }}"></button>
            {% endfor %}
        </div>
    </div>
    {% endif %}


    <!-- Recent Blogs -->
    <div class="row">
        {% for blog in recent_blogs %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm border-0">
                {% if blog.cover_image %}
                <img src="{{ url_for('static', filename='uploads/covers/' ~ blog.cover_image) }}" class="card-img-top"
                    alt="Cover Image" style="height: 180px; object-fit: cover;">
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-olive">{{ blog.title }}</h5>
                    <p class="card-subtitle text-muted mb-2">{{ blog.subtitle[:100] ~ ('...' if blog.subtitle|length >
                        100 else '') }}</p>
                    <small class="text-muted">Published on {{ blog.date_created|datetime }}</small>
                    <a href="{{ url_for('view_blog', id=blog.id) }}" class="btn btn-outline-olive mt-auto">Read More</a>
                </div>
            </div>
        </div>
        {% else %}
        <p class="text-center">No blogs available yet. Be the first to <a href="{{ url_for('create_blog') }}">write
                one</a>!</p>
        {% endfor %}
    </div>

</div>
{% endblock %}